{% liquid
  assign desktop_image = section.settings.desktop_image
  assign mobile_image = section.settings.mobile_image
  assign hero_image = desktop_image

  if mobile_image == blank
    assign mobile_image = desktop_image
  endif

  assign fetch_priority = 'auto'
  if section.index == 1
    assign fetch_priority = 'high'
  endif
%}

<div class="section-background color-{{ section.settings.color_scheme }}"></div>
<section
  class="section section--full-width custom-hero-banner color-{{ section.settings.color_scheme }}"
  id="custom-hero-{{ section.id }}"
  data-testid="custom-hero-{{ section.id }}"
  style="
    --hero-min-height-desktop: {{ section.settings.min_height_desktop }}svh;
    --hero-min-height-mobile: {{ section.settings.min_height_mobile }}svh;
    --hero-content-max-width: {{ section.settings.content_max_width }}px;
    --hero-content-padding: {{ section.settings.content_padding }}px;
    --hero-overlay-opacity: {{ section.settings.overlay_opacity | divided_by: 100.0 }};
    --hero-overlay-blur: {{ section.settings.overlay_blur }}px;
    --hero-panel-opacity: {{ section.settings.panel_opacity | divided_by: 100.0 }};
    --hero-gap: {{ section.settings.content_gap }}px;
    --hero-feature-gap: {{ section.settings.feature_gap }}px;
    --hero-heading-size-desktop: {{ section.settings.heading_size_desktop }}px;
    --hero-heading-size-mobile: {{ section.settings.heading_size_mobile }}px;
    --hero-text-size: {{ section.settings.text_size }}px;
    --hero-eyebrow-size: {{ section.settings.eyebrow_size }}px;
    --hero-media-position-desktop: {{ section.settings.media_position_desktop }};
    --hero-media-position-mobile: {{ section.settings.media_position_mobile }};
    --hero-content-justify: {{ section.settings.content_vertical }};
    --hero-content-align: {{ section.settings.content_horizontal }};
    --hero-text-align: {{ section.settings.text_alignment }};
    --hero-cta-gap: {{ section.settings.button_gap }}px;
    --hero-overlay-color: {{ section.settings.overlay_color }};
    --hero-panel-bg: {{ section.settings.panel_background }};
    --hero-panel-text: {{ section.settings.panel_text_color }};
    --hero-feature-bg: {{ section.settings.feature_background }};
    --hero-feature-text: {{ section.settings.feature_text_color }};
    --hero-feature-border: {{ section.settings.feature_border_color }};
  "
>
  <div class="custom-hero-banner__media">
    {% if hero_image != blank %}
      <picture>
        {% if mobile_image != blank %}
          <source
            media="(max-width: 749px)"
            srcset="
              {{ mobile_image | image_url: width: 480 }} 480w,
              {{ mobile_image | image_url: width: 720 }} 720w,
              {{ mobile_image | image_url: width: 960 }} 960w,
              {{ mobile_image | image_url: width: 1200 }} 1200w
            "
            sizes="100vw"
          >
        {% endif %}
        {{
          hero_image
          | image_url: width: 2400
          | image_tag:
            widths: '900, 1200, 1600, 2000, 2400',
            sizes: '100vw',
            alt: hero_image.alt,
            fetchpriority: fetch_priority,
            class: 'custom-hero-banner__image'
        }}
      </picture>
    {% else %}
      {{ 'lifestyle-2' | placeholder_svg_tag: 'custom-hero-banner__image custom-hero-banner__placeholder' }}
    {% endif %}
    {% if section.settings.enable_overlay %}
      <div class="custom-hero-banner__overlay"></div>
    {% endif %}
  </div>

  <div class="custom-hero-banner__content-wrap">
    <div class="custom-hero-banner__content">
      {% if section.settings.eyebrow != blank %}
        <p class="custom-hero-banner__eyebrow">{{ section.settings.eyebrow | escape }}</p>
      {% endif %}

      {% if section.settings.heading != blank %}
        <h2 class="custom-hero-banner__heading">{{ section.settings.heading | escape }}</h2>
      {% endif %}

      {% if section.settings.subheading != blank %}
        <div class="custom-hero-banner__subheading rte">{{ section.settings.subheading }}</div>
      {% endif %}

      {% if section.blocks.size > 0 %}
        <div class="custom-hero-banner__features">
          {% for block in section.blocks %}
            <div class="custom-hero-banner__feature" {{ block.shopify_attributes }}>
              {% if block.settings.icon != blank %}
                <span class="custom-hero-banner__feature-icon" aria-hidden="true">{{ block.settings.icon }}</span>
              {% endif %}
              <div class="custom-hero-banner__feature-content">
                {% if block.settings.title != blank %}
                  <p class="custom-hero-banner__feature-title">{{ block.settings.title | escape }}</p>
                {% endif %}
                {% if block.settings.caption != blank %}
                  <p class="custom-hero-banner__feature-caption">{{ block.settings.caption | escape }}</p>
                {% endif %}
              </div>
            </div>
          {% endfor %}
        </div>
      {% endif %}

      {% if section.settings.primary_label != blank or section.settings.secondary_label != blank %}
        <div class="custom-hero-banner__actions">
          {% if section.settings.primary_label != blank %}
            <a
              {% if section.settings.primary_link == blank %}
                role="link"
                aria-disabled="true"
              {% else %}
                href="{{ section.settings.primary_link }}"
              {% endif %}
              class="button"
            >
              {{ section.settings.primary_label | escape }}
            </a>
          {% endif %}

          {% if section.settings.secondary_label != blank %}
            <a
              {% if section.settings.secondary_link == blank %}
                role="link"
                aria-disabled="true"
              {% else %}
                href="{{ section.settings.secondary_link }}"
              {% endif %}
              class="button-secondary"
            >
              {{ section.settings.secondary_label | escape }}
            </a>
          {% endif %}
        </div>
      {% endif %}
    </div>
  </div>
</section>

{% stylesheet %}
  .custom-hero-banner {
    position: relative;
    isolation: isolate;
    min-height: var(--hero-min-height-mobile);
    display: grid;
    grid-template-columns: 1fr;
    align-items: stretch;
    overflow: clip;

    @media screen and (min-width: 750px) {
      min-height: var(--hero-min-height-desktop);
    }
  }

  .custom-hero-banner__media {
    position: absolute;
    inset: 0;
    z-index: 0;
  }

  .custom-hero-banner__image,
  .custom-hero-banner__placeholder {
    width: 100%;
    height: 100%;
    object-fit: cover;
    object-position: var(--hero-media-position-mobile);

    @media screen and (min-width: 750px) {
      object-position: var(--hero-media-position-desktop);
    }
  }

  .custom-hero-banner__overlay {
    position: absolute;
    inset: 0;
    background: color-mix(in srgb, var(--hero-overlay-color) calc(var(--hero-overlay-opacity) * 100%), transparent);
    backdrop-filter: blur(var(--hero-overlay-blur));
  }

  .custom-hero-banner__content-wrap {
    position: relative;
    z-index: 1;
    display: grid;
    justify-items: var(--hero-content-align);
    align-items: var(--hero-content-justify);
    padding: var(--hero-content-padding);
    min-height: inherit;
  }

  .custom-hero-banner__content {
    width: min(100%, var(--hero-content-max-width));
    background: color-mix(in srgb, var(--hero-panel-bg) calc(var(--hero-panel-opacity) * 100%), transparent);
    color: var(--hero-panel-text);
    text-align: var(--hero-text-align);
    padding: clamp(1rem, 2.5vw, 2.25rem);
    border-radius: var(--style-border-radius-buttons-primary);
    display: grid;
    gap: var(--hero-gap);
  }

  .custom-hero-banner__eyebrow {
    margin: 0;
    font-size: var(--hero-eyebrow-size);
    letter-spacing: 0.08em;
    text-transform: uppercase;
    opacity: 0.9;
  }

  .custom-hero-banner__heading {
    margin: 0;
    font-size: var(--hero-heading-size-mobile);
    line-height: 1.05;
    text-wrap: balance;

    @media screen and (min-width: 750px) {
      font-size: var(--hero-heading-size-desktop);
    }
  }

  .custom-hero-banner__subheading {
    margin: 0;
    font-size: var(--hero-text-size);
    line-height: 1.5;
  }

  .custom-hero-banner__subheading p {
    margin: 0;
  }

  .custom-hero-banner__features {
    display: grid;
    gap: var(--hero-feature-gap);
    grid-template-columns: 1fr;

    @media screen and (min-width: 750px) {
      grid-template-columns: repeat(2, minmax(0, 1fr));
    }
  }

  .custom-hero-banner__feature {
    display: flex;
    gap: 0.7rem;
    align-items: flex-start;
    padding: 0.75rem;
    border-radius: calc(var(--style-border-radius-buttons-primary) / 1.5);
    border: 1px solid var(--hero-feature-border);
    background: var(--hero-feature-bg);
    color: var(--hero-feature-text);
  }

  .custom-hero-banner__feature-icon {
    font-size: 1.1rem;
    line-height: 1.25;
  }

  .custom-hero-banner__feature-title,
  .custom-hero-banner__feature-caption {
    margin: 0;
    line-height: 1.35;
  }

  .custom-hero-banner__feature-title {
    font-weight: 600;
  }

  .custom-hero-banner__feature-caption {
    opacity: 0.85;
    font-size: 0.92em;
  }

  .custom-hero-banner__actions {
    display: flex;
    flex-wrap: wrap;
    gap: var(--hero-cta-gap);
  }

  .custom-hero-banner__actions .button,
  .custom-hero-banner__actions .button-secondary {
    text-decoration: none;
  }
{% endstylesheet %}

{% schema %}
{
  "name": "Custom hero banner",
  "tag": "section",
  "class": "section-wrapper",
  "settings": [
    {
      "type": "header",
      "content": "Media"
    },
    {
      "type": "image_picker",
      "id": "desktop_image",
      "label": "Desktop image"
    },
    {
      "type": "image_picker",
      "id": "mobile_image",
      "label": "Mobile image"
    },
    {
      "type": "text",
      "id": "media_position_desktop",
      "label": "Image focal point (desktop)",
      "default": "center center",
      "info": "Examples: center center, center top, right center"
    },
    {
      "type": "text",
      "id": "media_position_mobile",
      "label": "Image focal point (mobile)",
      "default": "center center",
      "info": "Examples: center center, center top, right center"
    },
    {
      "type": "range",
      "id": "min_height_desktop",
      "min": 40,
      "max": 100,
      "step": 1,
      "unit": "svh",
      "label": "Min height desktop",
      "default": 80
    },
    {
      "type": "range",
      "id": "min_height_mobile",
      "min": 35,
      "max": 100,
      "step": 1,
      "unit": "svh",
      "label": "Min height mobile",
      "default": 68
    },
    {
      "type": "header",
      "content": "Overlay and panel"
    },
    {
      "type": "checkbox",
      "id": "enable_overlay",
      "label": "Enable overlay",
      "default": true
    },
    {
      "type": "color",
      "id": "overlay_color",
      "label": "Overlay color",
      "default": "#0f172a"
    },
    {
      "type": "range",
      "id": "overlay_opacity",
      "min": 0,
      "max": 90,
      "step": 1,
      "unit": "%",
      "label": "Overlay opacity",
      "default": 35
    },
    {
      "type": "range",
      "id": "overlay_blur",
      "min": 0,
      "max": 20,
      "step": 1,
      "unit": "px",
      "label": "Overlay blur",
      "default": 0
    },
    {
      "type": "color",
      "id": "panel_background",
      "label": "Content panel color",
      "default": "#111827"
    },
    {
      "type": "range",
      "id": "panel_opacity",
      "min": 0,
      "max": 100,
      "step": 1,
      "unit": "%",
      "label": "Content panel opacity",
      "default": 68
    },
    {
      "type": "color",
      "id": "panel_text_color",
      "label": "Panel text color",
      "default": "#ffffff"
    },
    {
      "type": "header",
      "content": "Content"
    },
    {
      "type": "text",
      "id": "eyebrow",
      "label": "Eyebrow",
      "default": "New collection"
    },
    {
      "type": "text",
      "id": "heading",
      "label": "Heading",
      "default": "A fully custom hero banner"
    },
    {
      "type": "richtext",
      "id": "subheading",
      "label": "Subheading",
      "default": "<p>Tell your story with custom alignment, spacing, overlays, CTA styles, and feature chips.</p>"
    },
    {
      "type": "select",
      "id": "content_vertical",
      "label": "Vertical position",
      "options": [
        { "value": "start", "label": "Top" },
        { "value": "center", "label": "Center" },
        { "value": "end", "label": "Bottom" }
      ],
      "default": "center"
    },
    {
      "type": "select",
      "id": "content_horizontal",
      "label": "Horizontal position",
      "options": [
        { "value": "start", "label": "Left" },
        { "value": "center", "label": "Center" },
        { "value": "end", "label": "Right" }
      ],
      "default": "start"
    },
    {
      "type": "select",
      "id": "text_alignment",
      "label": "Text alignment",
      "options": [
        { "value": "left", "label": "Left" },
        { "value": "center", "label": "Center" },
        { "value": "right", "label": "Right" }
      ],
      "default": "left"
    },
    {
      "type": "range",
      "id": "content_max_width",
      "min": 320,
      "max": 1100,
      "step": 10,
      "unit": "px",
      "label": "Content max width",
      "default": 640
    },
    {
      "type": "range",
      "id": "content_padding",
      "min": 12,
      "max": 96,
      "step": 2,
      "unit": "px",
      "label": "Outer padding",
      "default": 36
    },
    {
      "type": "range",
      "id": "content_gap",
      "min": 8,
      "max": 42,
      "step": 1,
      "unit": "px",
      "label": "Content spacing",
      "default": 18
    },
    {
      "type": "range",
      "id": "heading_size_desktop",
      "min": 26,
      "max": 88,
      "step": 1,
      "unit": "px",
      "label": "Heading size desktop",
      "default": 56
    },
    {
      "type": "range",
      "id": "heading_size_mobile",
      "min": 22,
      "max": 64,
      "step": 1,
      "unit": "px",
      "label": "Heading size mobile",
      "default": 36
    },
    {
      "type": "range",
      "id": "eyebrow_size",
      "min": 10,
      "max": 24,
      "step": 1,
      "unit": "px",
      "label": "Eyebrow size",
      "default": 13
    },
    {
      "type": "range",
      "id": "text_size",
      "min": 12,
      "max": 28,
      "step": 1,
      "unit": "px",
      "label": "Subheading size",
      "default": 17
    },
    {
      "type": "header",
      "content": "Buttons"
    },
    {
      "type": "text",
      "id": "primary_label",
      "label": "Primary button label",
      "default": "Shop now"
    },
    {
      "type": "url",
      "id": "primary_link",
      "label": "Primary button link"
    },
    {
      "type": "text",
      "id": "secondary_label",
      "label": "Secondary button label",
      "default": "Learn more"
    },
    {
      "type": "url",
      "id": "secondary_link",
      "label": "Secondary button link"
    },
    {
      "type": "range",
      "id": "button_gap",
      "min": 6,
      "max": 28,
      "step": 1,
      "unit": "px",
      "label": "Button spacing",
      "default": 12
    },
    {
      "type": "header",
      "content": "Feature chips"
    },
    {
      "type": "color",
      "id": "feature_background",
      "label": "Feature chip background",
      "default": "#ffffff"
    },
    {
      "type": "color",
      "id": "feature_text_color",
      "label": "Feature chip text",
      "default": "#111827"
    },
    {
      "type": "color",
      "id": "feature_border_color",
      "label": "Feature chip border",
      "default": "#d1d5db"
    },
    {
      "type": "range",
      "id": "feature_gap",
      "min": 6,
      "max": 24,
      "step": 1,
      "unit": "px",
      "label": "Feature chip spacing",
      "default": 10
    },
    {
      "type": "color_scheme",
      "id": "color_scheme",
      "label": "Section color scheme",
      "default": "scheme-1"
    }
  ],
  "blocks": [
    {
      "type": "feature",
      "name": "Feature chip",
      "limit": 6,
      "settings": [
        {
          "type": "text",
          "id": "icon",
          "label": "Icon or emoji",
          "default": "*"
        },
        {
          "type": "text",
          "id": "title",
          "label": "Title",
          "default": "Fast shipping"
        },
        {
          "type": "text",
          "id": "caption",
          "label": "Caption",
          "default": "2-5 business days"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Custom hero banner",
      "blocks": [
        { "type": "feature" },
        { "type": "feature" },
        { "type": "feature" }
      ]
    }
  ]
}
{% endschema %}
